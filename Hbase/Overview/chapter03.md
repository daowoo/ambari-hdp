# 数据模型
表是HBase表达数据的逻辑组织方式，而基于列的存储则是数据在底层的组织方式。
![](/assets/a3.png)

## Table 
 - 与传统关系型数据库类似，HBase以表(Table)的方式组织数据，应用程序将数据存入HBase表中。
 - 用户可以通过命令行或JAVA API来创建表。
 - 表名通常用JAVA string类型或byte[]类型表示，作为HDFS存储路径的一部分来使用，因此必须要符合文件名规范。
 
## Row
 - HBase表中的行通过 RowKey 进行唯一标识，不论是数字还是字符串，最终都会转换成字节数组进行存储。
 - 行是按RowKey字典顺序排列，按照二进制字节从左至右逐一对比形成最终的次序。如row-1xxx小于row-2xxx，无论后面的xxx如何变化，row-1xxx都排在row-2xxx之前。
 - Rowkey被冗余存储，所以其长度不宜过长，避免占用大量空间同时降低检索效率。
 - 还应该尽量分布均匀，防止产生热点现象。
 - 必须在设计上保证其唯一性。


## Column Family
 - 表由行和列共同组织，同时引入列族的概念，它将一列或多列组织在一起，HBase的列必须属于某一个列族，在创建表时只需指定表名和至少一个列族。
 - 列族影响表的物理结构，创建表后列族还可以更改，但比较麻烦。
 
 
## Cell
 - 行和列的交叉点称为单元格，单元格的内容就是列的值。
 - 以二进制形式存储，同时它是版本化的。


## version
 - 每个cell的值可保存数据的多个版本，到底支持几个版本可在建表时指定。
 - 按时间顺序倒序排列，时间戳是64位的整数，可在写入数据时赋值，也可由RegionServer自动赋值。


## 特点
 - HBase没有数据类型，任何列值都被转换成字符串进行存储。
 - 与RDBMS在创建表时需明确包含的列及类型不同，HBase表的每一行可以有不同的列。
 - 相同RowKey的插入操作被认为是同一行的操作。即相同RowKey的二次写入操作，第二次可被可为是对该行某些列的更新操作。
 - 列由列族和列名连接而成， 分隔符是`:`，如  d:Name  （d: 列族名， Name: 列名）
 

## 结论
 - HBase不支持条件查询和Order by等查询，读取记录只能按Row key（及其range）或全表扫描。
 - 在表创建时只需声明表名和至少一个列族名，每个Column Family为一个存储单元。
 - Column不用创建表时定义即可以动态新增，同一Column Family的Columns会群聚在一个存储单元上，并依Column key排序，因此设计时应将具有相同I/O特性的Column设计在一个Column Family上以提高性能。
 - 通过row和column确定一份数据，这份数据的值可能有多个版本，不同版本的值按照时间倒序排序，即最新的数据排在最前面，查询时默认返回最新版本。
 - 每个单元格值通过4个键唯一索引，tableName+RowKey+ColumnKey+Timestamp=>value。

## 存储类型
 - TableName 是字符串（Java 类型 String）
 - RowKey 和 ColumnName 是二进制值（Java 类型 byte[]）
 - Timestamp 是一个 64 位整数（Java 类型 long）
 - value 是一个字节数组（Java类型 byte[]）