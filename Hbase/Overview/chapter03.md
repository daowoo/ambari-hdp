# 数据模型
表是HBase表达数据的逻辑组织方式，而基于列的存储则是数据在底层的组织方式。
![](/assets/a3.png)

## 表
- 数据以表的形式存储。用户可以通过命令行或JAVA API来创建表。表名通常用JAVA string类型或byte[]类型表示，表名作为HDFS存储路径的一部分来使用，因此必须要符合文件名规范。

- 逻辑上看，表是由行和列组成的，但从物理结构上看，表存储在不同的分区，即不同的Region。每个Region只在一个RegionServer中提供服务，而Region直接向客户端提供存储和读取服务。

- HBase提供了命令行创建表，创建表时只需要指定表名和至少一个列族。列族影响表的物理结构，创建表后列族还可以更改，但比较麻烦。

- 通过Shell或Java API来与HBase建立连接，不过访问HBase不需要用户名和密码，没有Schema，将hbase-site.xml配置文件复制一份到自己的工程中，HBase API会读取配置文件来完成连接。但创建连接是一项非常消耗资源的工作，HBase为我们提供了一个连接池（HTablePool）可以更好地管理资源重用。

## 行键
- 行键（RowKey）是不可分割的字节数组，行键是按字典排序由低到高存储在表中的，以一个空的数组来标识表空间的起始和结尾。

- 按字典排序中，数据是按照二进制字节从左至右逐一对比形成最终的次序。如row-1xxx小于row-2xxx，无论后面的xxx如何变化，row-1xxx都排在row-2xxx之前。

- Rowkey被冗余存储，所以其长度不宜过长，避免占用大量空间同时降低检索效率；还应该尽量分布均匀，防止产生热点现象；必须在设计上保证其唯一性。

## 列族
列族是若干列的集合。一个列族中所有列成员有着相同的前缀，冒号（：）是列族的分隔符，用来区分列族前缀和列名。列族前缀必须是可打印的字符，剩下的部分（Qualifier）可以由任意字节数组组成。如：列bigdata:admin 、bigdata:user 都是列族bigdata的成员。

## 单元格
- HBase中的单元格由行键、列族、列、时间戳唯一确定。单元格的内容是不可分割的字节数组。

- 每个单元格都保存着同一份数据的多个版本，不同时间版本的数据按照时间顺序倒序排序，最新时间的数据排在前面，时间戳是64位的整数，可以由客户端在写入数据时赋值，也可以由RegionServer自动赋值。